<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hospital Management - Ward & Bed Control</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3f51b5;
            --primary-dark: #303f9f;
            --accent: #ff4081;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --light: #f5f5f5;
            --dark: #212121;
            --gray: #757575;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f0f2f5;
            color: var(--dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        h1 {
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* Ward Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        /* Ward Sidebar */
        .ward-sidebar {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 20px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .ward-list {
            list-style: none;
            margin-top: 20px;
        }

        .ward-item {
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ward-item:hover {
            background-color: #f5f5f5;
        }

        .ward-item.active {
            background-color: var(--primary);
            color: white;
        }

        .ward-status {
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 12px;
            background-color: #e0e0e0;
        }

        .ward-item.active .ward-status {
            background-color: rgba(255,255,255,0.2);
        }

        /* Bed Management */
        .bed-management {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 20px;
        }

        .ward-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .ward-title {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .ward-stats {
            display: flex;
            gap: 15px;
        }

        .stat-card {
            padding: 10px 15px;
            border-radius: 6px;
            background-color: #f5f5f5;
            text-align: center;
            min-width: 100px;
        }

        .stat-value {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Bed Grid */
        .bed-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .bed-card {
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .bed-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .bed-card.vacant {
            background-color: #e8f5e9;
            border: 1px solid #a5d6a7;
        }

        .bed-card.occupied {
            background-color: #ffebee;
            border: 1px solid #ef9a9a;
        }

        .bed-card.maintenance {
            background-color: #fff8e1;
            border: 1px solid #ffe082;
        }

        .bed-card.reserved {
            background-color: #e3f2fd;
            border: 1px solid #90caf9;
        }

        .bed-number {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .bed-status {
            font-size: 0.8rem;
            padding: 3px 10px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 10px;
        }

        .vacant .bed-status {
            background-color: #c8e6c9;
            color: #2e7d32;
        }

        .occupied .bed-status {
            background-color: #ffcdd2;
            color: #c62828;
        }

        .maintenance .bed-status {
            background-color: #fff0c2;
            color: #f57f17;
        }

        .reserved .bed-status {
            background-color: #bbdefb;
            color: #1565c0;
        }

        .bed-patient {
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 5px;
        }

        .bed-admission {
            font-size: 0.7rem;
            color: var(--gray);
        }

        .bed-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .bed-card:hover .bed-actions {
            opacity: 1;
        }

        .action-btn {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-weight: 600;
        }

        .close-modal {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .form-select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 1em;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .ward-sidebar {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .bed-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
            
            .ward-stats {
                flex-wrap: wrap;
            }
        }
        
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-procedures"></i> Ward & Bed Management</h1>
            <button class="btn btn-primary" id="addWardBtn">
                <i class="fas fa-plus"></i> Add Ward
            </button>
        </header>

        <div class="dashboard">
            <!-- Ward Sidebar -->
            <div class="ward-sidebar">
                <div class="search-box">
                    <input type="text" class="form-control" placeholder="Search wards...">
                </div>
                
                <ul class="ward-list" id="wardList">
                    <!-- Wards will be populated here -->
                </ul>
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 15px;" id="addWardSidebarBtn">
                    <i class="fas fa-plus"></i> New Ward
                </button>
            </div>
            
            <!-- Bed Management -->
            <div class="bed-management">
                <div class="ward-header">
                    <div>
                        <h2 class="ward-title" id="currentWardTitle">General Ward A</h2>
                        <div style="font-size: 0.9rem; color: var(--gray);">Ward ID: <span id="currentWardId">WARD-001</span></div>
                    </div>
                    
                    <div class="ward-stats">
                        <div class="stat-card">
                            <div class="stat-value" id="totalBeds">24</div>
                            <div class="stat-label">Total Beds</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="occupiedBeds">18</div>
                            <div class="stat-label">Occupied</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="availableBeds">6</div>
                            <div class="stat-label">Available</div>
                        </div>
                    </div>
                </div>
                
                <div class="bed-controls">
                    <button class="btn btn-primary" id="addBedBtn">
                        <i class="fas fa-bed"></i> Add Bed
                    </button>
                    <button class="btn" style="background-color: #e0e0e0;" id="filterBedsBtn">
                        <i class="fas fa-filter"></i> Filter
                    </button>
                </div>
                
                <div class="bed-grid" id="bedGrid">
                    <!-- Beds will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Ward Modal -->
    <div class="modal" id="wardModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add New Ward</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="wardForm">
                    <div class="form-group">
                        <label class="form-label">Ward Name</label>
                        <input type="text" class="form-control" id="wardName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ward Type</label>
                        <select class="form-select" id="wardType" required>
                            <option value="">Select Ward Type</option>
                            <option value="general">General Ward</option>
                            <option value="icu">Intensive Care Unit (ICU)</option>
                            <option value="pediatric">Pediatric Ward</option>
                            <option value="maternity">Maternity Ward</option>
                            <option value="surgical">Surgical Ward</option>
                            <option value="isolation">Isolation Ward</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ward Code</label>
                        <input type="text" class="form-control" id="wardCode" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Floor Number</label>
                        <input type="number" class="form-control" id="wardFloor" min="1" max="20">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Initial Beds</label>
                        <input type="number" class="form-control" id="wardBeds" min="1" max="50" value="10">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelWardBtn">Cancel</button>
                <button class="btn btn-primary" id="saveWardBtn">Save Ward</button>
            </div>
        </div>
    </div>

    <!-- Bed Management Modal -->
    <div class="modal" id="bedModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="bedModalTitle">Manage Bed</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="bedForm">
                    <input type="hidden" id="bedId">
                    <div class="form-group">
                        <label class="form-label">Bed Status</label>
                        <select class="form-select" id="bedStatus" required>
                            <option value="vacant">Vacant</option>
                            <option value="occupied">Occupied</option>
                            <option value="reserved">Reserved</option>
                            <option value="maintenance">Maintenance</option>
                        </select>
                    </div>
                    
                    <div id="patientFields" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Patient</label>
                            <select class="form-select" id="bedPatient">
                                <option value="">Select Patient</option>
                                <!-- Patients will be populated here -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Admission Date</label>
                            <input type="datetime-local" class="form-control" id="admissionDate">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Discharge Date</label>
                            <input type="datetime-local" class="form-control" id="dischargeDate">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Attending Physician</label>
                            <select class="form-select" id="attendingDoctor">
                                <option value="">Select Doctor</option>
                                <!-- Doctors will be populated here -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <textarea class="form-control" id="bedNotes" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancelBedBtn">Cancel</button>
                <button class="btn btn-primary" id="saveBedBtn">Save Changes</button>
            </div>
        </div>
    </div>

    <script>
        // Sample Data
        let wards = [
            {
                id: 'WARD-001',
                name: 'General Ward A',
                type: 'general',
                floor: 2,
                beds: [
                    { id: 'BED-001', status: 'occupied', patient: 'John Doe', admission: '2025-06-15T10:00', discharge: '2025-06-20T10:00', doctor: 'Dr. Smith', notes: '' },
                    { id: 'BED-002', status: 'vacant', notes: 'Recently cleaned' },
                    { id: 'BED-003', status: 'occupied', patient: 'Jane Smith', admission: '2025-06-16T14:30', discharge: '', doctor: 'Dr. Johnson', notes: 'Post-op recovery' },
                    { id: 'BED-004', status: 'maintenance', notes: 'Mattress replacement needed' },
                    { id: 'BED-005', status: 'vacant', notes: '' },
                    { id: 'BED-006', status: 'reserved', patient: 'Robert Brown', admission: '2025-06-18T09:00', discharge: '', doctor: 'Dr. Williams', notes: 'Scheduled for surgery' }
                ]
            },
            {
                id: 'WARD-002',
                name: 'Intensive Care Unit',
                type: 'icu',
                floor: 3,
                beds: [
                    { id: 'ICU-001', status: 'occupied', patient: 'Sarah Johnson', admission: '2025-06-10T08:00', discharge: '', doctor: 'Dr. Anderson', notes: 'Critical condition' },
                    { id: 'ICU-002', status: 'occupied', patient: 'Michael Wilson', admission: '2025-06-12T11:30', discharge: '', doctor: 'Dr. Lee', notes: 'Ventilator support' },
                    { id: 'ICU-003', status: 'vacant', notes: '' }
                ]
            }
        ];

        let patients = [
            { id: 'PAT-001', name: 'John Doe', gender: 'Male', age: 45 },
            { id: 'PAT-002', name: 'Jane Smith', gender: 'Female', age: 32 },
            { id: 'PAT-003', name: 'Robert Brown', gender: 'Male', age: 58 },
            { id: 'PAT-004', name: 'Sarah Johnson', gender: 'Female', age: 67 },
            { id: 'PAT-005', name: 'Michael Wilson', gender: 'Male', age: 29 }
        ];

        let doctors = [
            { id: 'DOC-001', name: 'Dr. Smith', specialization: 'General Medicine' },
            { id: 'DOC-002', name: 'Dr. Johnson', specialization: 'Surgery' },
            { id: 'DOC-003', name: 'Dr. Williams', specialization: 'Cardiology' },
            { id: 'DOC-004', name: 'Dr. Anderson', specialization: 'ICU' },
            { id: 'DOC-005', name: 'Dr. Lee', specialization: 'Neurology' }
        ];

        // DOM Elements
        const wardList = document.getElementById('wardList');
        const bedGrid = document.getElementById('bedGrid');
        const currentWardTitle = document.getElementById('currentWardTitle');
        const currentWardId = document.getElementById('currentWardId');
        const totalBeds = document.getElementById('totalBeds');
        const occupiedBeds = document.getElementById('occupiedBeds');
        const availableBeds = document.getElementById('availableBeds');
        
        // Modal Elements
        const wardModal = document.getElementById('wardModal');
        const bedModal = document.getElementById('bedModal');
        const wardForm = document.getElementById('wardForm');
        const bedForm = document.getElementById('bedForm');
        const bedStatusSelect = document.getElementById('bedStatus');
        const patientFields = document.getElementById('patientFields');
        const bedPatientSelect = document.getElementById('bedPatient');
        const attendingDoctorSelect = document.getElementById('attendingDoctor');
        
        // Buttons
        const addWardBtn = document.getElementById('addWardBtn');
        const addWardSidebarBtn = document.getElementById('addWardSidebarBtn');
        const addBedBtn = document.getElementById('addBedBtn');
        const saveWardBtn = document.getElementById('saveWardBtn');
        const cancelWardBtn = document.getElementById('cancelWardBtn');
        const saveBedBtn = document.getElementById('saveBedBtn');
        const cancelBedBtn = document.getElementById('cancelBedBtn');
        
        // Current Ward
        let currentWard = wards[0];
        
        // Initialize the application
        function init() {
            renderWardList();
            renderBedGrid();
            populatePatientSelect();
            populateDoctorSelect();
            setupEventListeners();
        }
        
        // Render ward list in sidebar
        function renderWardList() {
            wardList.innerHTML = '';
            
            wards.forEach(ward => {
                const occupied = ward.beds.filter(bed => bed.status === 'occupied').length;
                const total = ward.beds.length;
                
                const wardItem = document.createElement('li');
                wardItem.className = `ward-item ${ward.id === currentWard.id ? 'active' : ''}`;
                wardItem.innerHTML = `
                    <span>${ward.name}</span>
                    <span class="ward-status">${occupied}/${total}</span>
                `;
                wardItem.dataset.wardId = ward.id;
                
                wardItem.addEventListener('click', () => {
                    currentWard = ward;
                    renderWardList();
                    renderBedGrid();
                    updateWardHeader();
                });
                
                wardList.appendChild(wardItem);
            });
        }
        
        // Render bed grid for current ward
        function renderBedGrid() {
            bedGrid.innerHTML = '';
            
            currentWard.beds.forEach(bed => {
                const bedCard = document.createElement('div');
                bedCard.className = `bed-card ${bed.status}`;
                bedCard.dataset.bedId = bed.id;
                
                let patientInfo = '';
                let admissionInfo = '';
                
                if (bed.status === 'occupied' || bed.status === 'reserved') {
                    patientInfo = `<div class="bed-patient">${bed.patient || ''}</div>`;
                    
                    if (bed.admission) {
                        const admDate = new Date(bed.admission);
                        admissionInfo = `<div class="bed-admission">Admitted: ${admDate.toLocaleDateString()}</div>`;
                    }
                }
                
                bedCard.innerHTML = `
                    <div class="bed-actions">
                        <div class="action-btn" title="Edit"><i class="fas fa-edit"></i></div>
                        <div class="action-btn" title="Transfer"><i class="fas fa-exchange-alt"></i></div>
                    </div>
                    <div class="bed-number">${bed.id}</div>
                    <div class="bed-status">${bed.status.charAt(0).toUpperCase() + bed.status.slice(1)}</div>
                    ${patientInfo}
                    ${admissionInfo}
                `;
                
                bedCard.addEventListener('click', () => {
                    openBedModal(bed);
                });
                
                bedGrid.appendChild(bedCard);
            });
            
            // Add "Add Bed" card
            const addBedCard = document.createElement('div');
            addBedCard.className = 'bed-card vacant';
            addBedCard.innerHTML = `
                <div class="bed-number"><i class="fas fa-plus"></i></div>
                <div class="bed-status">Add Bed</div>
            `;
            addBedCard.addEventListener('click', () => {
                addNewBed();
            });
            
            bedGrid.appendChild(addBedCard);
            
            updateWardStats();
        }
        
        // Update ward header information
        function updateWardHeader() {
            currentWardTitle.textContent = currentWard.name;
            currentWardId.textContent = currentWard.id;
        }
        
        // Update ward statistics
        function updateWardStats() {
            const total = currentWard.beds.length;
            const occupied = currentWard.beds.filter(bed => bed.status === 'occupied').length;
            const available = currentWard.beds.filter(bed => bed.status === 'vacant').length;
            
            totalBeds.textContent = total;
            occupiedBeds.textContent = occupied;
            availableBeds.textContent = available;
        }
        
        // Populate patient select dropdown
        function populatePatientSelect() {
            bedPatientSelect.innerHTML = '<option value="">Select Patient</option>';
            
            patients.forEach(patient => {
                const option = document.createElement('option');
                option.value = patient.id;
                option.textContent = `${patient.name} (${patient.gender}, ${patient.age})`;
                bedPatientSelect.appendChild(option);
            });
        }
        
        // Populate doctor select dropdown
        function populateDoctorSelect() {
            attendingDoctorSelect.innerHTML = '<option value="">Select Doctor</option>';
            
            doctors.forEach(doctor => {
                const option = document.createElement('option');
                option.value = doctor.id;
                option.textContent = `${doctor.name} (${doctor.specialization})`;
                attendingDoctorSelect.appendChild(option);
            });
        }
        
        // Open bed modal with bed data
        function openBedModal(bed) {
            document.getElementById('bedModalTitle').textContent = `Manage ${bed.id}`;
            document.getElementById('bedId').value = bed.id;
            document.getElementById('bedStatus').value = bed.status;
            document.getElementById('bedNotes').value = bed.notes || '';
            
            if (bed.status === 'occupied' || bed.status === 'reserved') {
                patientFields.style.display = 'block';
                document.getElementById('bedPatient').value = patients.find(p => p.name === bed.patient)?.id || '';
                document.getElementById('admissionDate').value = bed.admission || '';
                document.getElementById('dischargeDate').value = bed.discharge || '';
                document.getElementById('attendingDoctor').value = doctors.find(d => d.name === bed.doctor)?.id || '';
            } else {
                patientFields.style.display = 'none';
            }
            
            bedModal.style.display = 'flex';
        }
        
        // Add new bed to current ward
        function addNewBed() {
            const bedNumber = currentWard.beds.length + 1;
            const bedId = currentWard.type === 'icu' ? `ICU-${bedNumber.toString().padStart(3, '0')}` : `BED-${bedNumber.toString().padStart(3, '0')}`;
            
            const newBed = {
                id: bedId,
                status: 'vacant',
                notes: ''
            };
            
            currentWard.beds.push(newBed);
            renderBedGrid();
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Ward modal buttons
            addWardBtn.addEventListener('click', () => {
                wardModal.style.display = 'flex';
                wardForm.reset();
            });
            
            addWardSidebarBtn.addEventListener('click', () => {
                wardModal.style.display = 'flex';
                wardForm.reset();
            });
            
            cancelWardBtn.addEventListener('click', () => {
                wardModal.style.display = 'none';
            });
            
            saveWardBtn.addEventListener('click', () => {
                const wardName = document.getElementById('wardName').value;
                const wardType = document.getElementById('wardType').value;
                const wardCode = document.getElementById('wardCode').value;
                const wardFloor = document.getElementById('wardFloor').value;
                const wardBeds = parseInt(document.getElementById('wardBeds').value);
                
                // Create new ward
                const newWard = {
                    id: wardCode,
                    name: wardName,
                    type: wardType,
                    floor: wardFloor,
                    beds: Array.from({ length: wardBeds }, (_, i) => ({
                        id: `${wardType === 'icu' ? 'ICU' : 'BED'}-${(i + 1).toString().padStart(3, '0')}`,
                        status: 'vacant',
                        notes: ''
                    }))
                };
                
                wards.push(newWard);
                wardModal.style.display = 'none';
                currentWard = newWard;
                renderWardList();
                renderBedGrid();
                updateWardHeader();
            });
            
            // Bed modal buttons
            cancelBedBtn.addEventListener('click', () => {
                bedModal.style.display = 'none';
            });
            
            saveBedBtn.addEventListener('click', () => {
                const bedId = document.getElementById('bedId').value;
                const status = document.getElementById('bedStatus').value;
                const notes = document.getElementById('bedNotes').value;
                
                // Find bed in current ward
                const bedIndex = currentWard.beds.findIndex(b => b.id === bedId);
                
                if (bedIndex !== -1) {
                    currentWard.beds[bedIndex].status = status;
                    currentWard.beds[bedIndex].notes = notes;
                    
                    if (status === 'occupied' || status === 'reserved') {
                        const patientId = document.getElementById('bedPatient').value;
                        const patient = patients.find(p => p.id === patientId);
                        currentWard.beds[bedIndex].patient = patient ? patient.name : '';
                        currentWard.beds[bedIndex].admission = document.getElementById('admissionDate').value;
                        currentWard.beds[bedIndex].discharge = document.getElementById('dischargeDate').value;
                        
                        const doctorId = document.getElementById('attendingDoctor').value;
                        const doctor = doctors.find(d => d.id === doctorId);
                        currentWard.beds[bedIndex].doctor = doctor ? doctor.name : '';
                    } else {
                        delete currentWard.beds[bedIndex].patient;
                        delete currentWard.beds[bedIndex].admission;
                        delete currentWard.beds[bedIndex].discharge;
                        delete currentWard.beds[bedIndex].doctor;
                    }
                    
                    renderBedGrid();
                    bedModal.style.display = 'none';
                }
            });
            
            // Bed status change
            bedStatusSelect.addEventListener('change', () => {
                if (bedStatusSelect.value === 'occupied' || bedStatusSelect.value === 'reserved') {
                    patientFields.style.display = 'block';
                } else {
                    patientFields.style.display = 'none';
                }
            });
            
            // Add bed button
            addBedBtn.addEventListener('click', addNewBed);
            
            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === wardModal) {
                    wardModal.style.display = 'none';
                }
                if (e.target === bedModal) {
                    bedModal.style.display = 'none';
                }
            });
        }
        
        // Initialize the application
        init();
    </script>
</body>
</html>